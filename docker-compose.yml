# PyFleet Docker POC - Fleet of agents with distinct hostnames
#
# Usage (Mac):
#   1. Start the dashboard: PYTHONPATH=.. python3 run_dashboard.py
#   2. Launch agents: docker-compose up --build

services:
  node-alpha:
    build:
      context: .
      dockerfile: Dockerfile.client
    hostname: node-alpha
    environment:
      - SERVER_ADDRESS=host.docker.internal:9999
      - AGENT_NAME=alpha
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: on-failure:3

  node-bravo:
    build:
      context: .
      dockerfile: Dockerfile.client
    hostname: node-bravo
    environment:
      - SERVER_ADDRESS=host.docker.internal:9999
      - AGENT_NAME=bravo
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: on-failure:3

  node-charlie:
    build:
      context: .
      dockerfile: Dockerfile.client
    hostname: node-charlie
    environment:
      - SERVER_ADDRESS=host.docker.internal:9999
      - AGENT_NAME=charlie
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: on-failure:3

  node-delta:
    build:
      context: .
      dockerfile: Dockerfile.client
    hostname: node-delta
    environment:
      - SERVER_ADDRESS=host.docker.internal:9999
      - AGENT_NAME=delta
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: on-failure:3

  node-echo:
    build:
      context: .
      dockerfile: Dockerfile.client
    hostname: node-echo
    environment:
      - SERVER_ADDRESS=host.docker.internal:9999
      - AGENT_NAME=echo
    extra_hosts:
      - "host.docker.internal:host-gateway"
    restart: on-failure:3
